{"format_version":"0.1","terraform_version":"0.14.5","variables":{"access_logging_bucket_name_prefix":{"value":"acme-s3-access-logs"},"aws_region":{"value":"us-east-1"},"environment":{"value":"security"},"logging_bucket_name":{"value":"acme-cloudtrail-logging"},"logging_trail_name":{"value":"AcmeTrailLogging"},"purpose":{"value":"logging"}},"planned_values":{"outputs":{"account_id":{"sensitive":false,"value":"451349303221"},"caller_arn":{"sensitive":false,"value":"arn:aws:iam::451349303221:user/david.doughty"}},"root_module":{"resources":[{"address":"aws_cloudtrail.logging_trail","mode":"managed","type":"aws_cloudtrail","name":"logging_trail","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":true,"event_selector":[],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":true,"is_organization_trail":false,"kms_key_id":null,"name":"var.logging_trail_name","s3_key_prefix":null,"sns_topic_name":null,"tags":null}},{"address":"aws_kms_alias.logging_key_alias","mode":"managed","type":"aws_kms_alias","name":"logging_key_alias","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"alias/logging-key","name_prefix":null}},{"address":"aws_kms_key.logging_key","mode":"managed","type":"aws_kms_key","name":"logging_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":null,"enable_key_rotation":false,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Id\": \"cloudtrail-key-policy\",\n    \"Statement\": [\n        {\n            \"Sid\": \"Enable IAM User Permissions\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::451349303221:root\"\n            },\n            \"Action\": \"kms:*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"Enable CloudTrail\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"kms:GenerateDataKey*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n              \"StringLike\": {\n                \"kms:EncryptionContext:aws:cloudtrail:arn\": [\n                  \"arn:aws:cloudtrail:*:123456789012:trail/*\"\n                ]\n              }\n            }\n        },\n        {\n            \"Sid\": \"Allow CloudTrail access\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"kms:DescribeKey\",\n            \"Principal\": {\n              \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Resource\": \"*\"\n        }\n    ]\n}\n","tags":null}},{"address":"aws_s3_bucket.logging_bucket","mode":"managed","type":"aws_s3_bucket","name":"logging_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","bucket":"acme-cloudtrail-logging","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[],"tags":null,"website":[]}},{"address":"aws_s3_bucket_policy.logging_bucket","mode":"managed","type":"aws_s3_bucket_policy","name":"logging_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0}]}},"resource_changes":[{"address":"aws_cloudtrail.logging_trail","mode":"managed","type":"aws_cloudtrail","name":"logging_trail","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":true,"event_selector":[],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":true,"is_organization_trail":false,"kms_key_id":null,"name":"var.logging_trail_name","s3_key_prefix":null,"sns_topic_name":null,"tags":null},"after_unknown":{"arn":true,"event_selector":[],"home_region":true,"id":true,"insight_selector":[],"s3_bucket_name":true}}},{"address":"aws_kms_alias.logging_key_alias","mode":"managed","type":"aws_kms_alias","name":"logging_key_alias","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"alias/logging-key","name_prefix":null},"after_unknown":{"arn":true,"id":true,"target_key_arn":true,"target_key_id":true}}},{"address":"aws_kms_key.logging_key","mode":"managed","type":"aws_kms_key","name":"logging_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":null,"enable_key_rotation":false,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Id\": \"cloudtrail-key-policy\",\n    \"Statement\": [\n        {\n            \"Sid\": \"Enable IAM User Permissions\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::451349303221:root\"\n            },\n            \"Action\": \"kms:*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"Enable CloudTrail\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"kms:GenerateDataKey*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n              \"StringLike\": {\n                \"kms:EncryptionContext:aws:cloudtrail:arn\": [\n                  \"arn:aws:cloudtrail:*:123456789012:trail/*\"\n                ]\n              }\n            }\n        },\n        {\n            \"Sid\": \"Allow CloudTrail access\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"kms:DescribeKey\",\n            \"Principal\": {\n              \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Resource\": \"*\"\n        }\n    ]\n}\n","tags":null},"after_unknown":{"arn":true,"description":true,"id":true,"key_id":true}}},{"address":"aws_s3_bucket.logging_bucket","mode":"managed","type":"aws_s3_bucket","name":"logging_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","bucket":"acme-cloudtrail-logging","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[],"tags":null,"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[],"versioning":true,"website":[],"website_domain":true,"website_endpoint":true}}},{"address":"aws_s3_bucket_policy.logging_bucket","mode":"managed","type":"aws_s3_bucket_policy","name":"logging_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"bucket":true,"id":true,"policy":true}}}],"output_changes":{"account_id":{"actions":["create"],"before":null,"after":"451349303221","after_unknown":false},"caller_arn":{"actions":["create"],"before":null,"after":"arn:aws:iam::451349303221:user/david.doughty","after_unknown":false}},"prior_state":{"format_version":"0.1","terraform_version":"0.14.5","values":{"outputs":{"account_id":{"sensitive":false,"value":"451349303221"},"caller_arn":{"sensitive":false,"value":"arn:aws:iam::451349303221:user/david.doughty"}},"root_module":{"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"451349303221","arn":"arn:aws:iam::451349303221:user/david.doughty","id":"451349303221","user_id":"AIDAJZQNIYD35PIB42PU4"}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","expressions":{"profile":{"constant_value":"david.doughty"},"region":{"constant_value":"us-west-2"},"shared_credentials_file":{"constant_value":"/Users/ddoughty/.aws/credentials"}}}},"root_module":{"outputs":{"account_id":{"expression":{"references":["data.aws_caller_identity.current"]}},"caller_arn":{"expression":{"references":["data.aws_caller_identity.current"]}}},"resources":[{"address":"aws_cloudtrail.logging_trail","mode":"managed","type":"aws_cloudtrail","name":"logging_trail","provider_config_key":"aws","expressions":{"enable_logging":{"constant_value":true},"include_global_service_events":{"constant_value":true},"is_multi_region_trail":{"constant_value":true},"name":{"constant_value":"var.logging_trail_name"},"s3_bucket_name":{"references":["aws_s3_bucket.logging_bucket"]}},"schema_version":0},{"address":"aws_kms_alias.logging_key_alias","mode":"managed","type":"aws_kms_alias","name":"logging_key_alias","provider_config_key":"aws","expressions":{"name":{"constant_value":"alias/logging-key"},"target_key_id":{"references":["aws_kms_key.logging_key"]}},"schema_version":0},{"address":"aws_kms_key.logging_key","mode":"managed","type":"aws_kms_key","name":"logging_key","provider_config_key":"aws","expressions":{"is_enabled":{"constant_value":true},"policy":{"references":["data.aws_caller_identity.current"]}},"schema_version":0},{"address":"aws_s3_bucket.logging_bucket","mode":"managed","type":"aws_s3_bucket","name":"logging_bucket","provider_config_key":"aws","expressions":{"acl":{"constant_value":"private"},"bucket":{"references":["var.logging_bucket_name"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.logging_bucket","mode":"managed","type":"aws_s3_bucket_policy","name":"logging_bucket","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logging_bucket"]},"policy":{"references":["aws_s3_bucket.logging_bucket","aws_s3_bucket.logging_bucket","aws_s3_bucket.logging_bucket"]}},"schema_version":0},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0}],"variables":{"access_logging_bucket_name_prefix":{"default":"acme-s3-access-logs"},"aws_region":{"default":"us-east-1"},"environment":{"default":"security"},"logging_bucket_name":{"default":"acme-cloudtrail-logging"},"logging_trail_name":{"default":"AcmeTrailLogging"},"purpose":{"default":"logging"}}}}}
